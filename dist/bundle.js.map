{"version":3,"file":"bundle.js","sources":["../src/actions.js","../src/index.js","../src/utils.js"],"sourcesContent":["let ftns = document.querySelectorAll(\"t-ftn\"); //selects all footnotes\n\n//options\nlet options = document.querySelector(\"t-options\");\nvar hover = options.dataset.hover === 'true';\nvar unhover = options.dataset.unhoverdelete === 'true';\nlet hoverDelay = options.dataset.hoverdelay === undefined ? 0 : options.dataset.hoverdelay;\n\nexport function setHoverDelay(delay){\n    hoverDelay = delay\n}\n\nexport function initializeFootnotes(){\n\n  for(let i of ftns){\n      i.removeEventListener(\"mouseenter\", addFootnote);\n      i.removeEventListener(\"click\", removeFootnote);\n      i.removeEventListener(\"click\", toggleFootnote);\n      i.removeEventListener(\"mouseout\", removeFootnoteWithTimer);\n  \n      // hover/click option hub (more options to be added)\n      if(hover){\n          i.addEventListener(\"mouseenter\", addFootnote);\n          i.addEventListener(\"click\", removeFootnote);\n      }else{\n          i.addEventListener(\"click\", toggleFootnote);  \n      }\n  \n      if(unhover){\n          i.addEventListener(\"mouseout\", removeFootnoteWithTimer);\n      }\n  }\n}\n\nexport function toggleHover(){    \n    hover = !hover;\n    initializeFootnotes();\n}\n\nexport function toggleUnhover(){\n    unhover = !unhover;\n    initializeFootnotes();\n}\n\n// toggles visibility when the note is clicked\nexport function toggleFootnote(){\n    removeAllFootnotes(this);\n    var vis = this.shadowRoot.children[1].style.visibility;\n    if(vis == 'hidden'){\n        this.shadowRoot.children[1].style.visibility = 'visible';\n    }else{\n        this.shadowRoot.children[1].style.visibility = 'hidden';\n    }\n}\n\n// adds visibility to clicked footnote\nexport function addFootnote(){\n    removeAllFootnotes();\n    this.shadowRoot.children[1].style.visibility = 'visible';\n}\n\n// removes visibility from clicked footnote\nexport function removeFootnote(){\n    this.shadowRoot.children[1].style.visibility = 'hidden';\n}\n\n// removes visibility from clicked footnote with timer (for hover delay)\nexport async function removeFootnoteWithTimer(){\n    setTimeout(() => {\n        this.shadowRoot.children[1].style.visibility = 'hidden';\n    }, hoverDelay);\n}\n\n// removes visibility from all footnotes except for current note (if there is one)\n// curr = current note\nexport function removeAllFootnotes(curr){\n    document.querySelectorAll('t-ftn').forEach(ftn => {\n        if(ftn !== curr){\n            ftn.shadowRoot.children[1].style.visibility = 'hidden';\n        }\n    })\n}\n\n\n","import {removeAllFootnotes, initializeFootnotes, toggleHover, toggleUnhover} from './actions.js'\nimport {distance} from './utils.js'\n\n//removes all footnotes except the one that is opened\nwindow.addEventListener(\"click\", (e) => removeAllFootnotes(e.target));\ninitializeFootnotes();\n\n// Create a class for the element\nclass Footnote extends HTMLElement {\n    constructor() {\n      // Always call super first in constructor\n      super();\n      this.content = \"\"\n    }\n  \n    connectedCallback() {\n        const shadow = this.attachShadow({ mode: \"open\" });\n        const child = this.children.item(0);\n        console.log(this.children)\n        if (child && child.matches(\"a[href]\")) {\n            this.content = child.innerText;\n            child.innerText = \"\";\n            this.removeChild(child);\n            shadow.appendChild(child);\n        }\n\n        const aside = document.createElement(\"aside\");\n        aside.part = \"aside\"\n        aside.style.visibility = 'hidden';\n        aside.classList.add(\"aside\")\n        const inside = document.createElement(\"div\");\n        inside.part = \"content\"\n        const arr = document.createElement(\"div\");\n        arr.part = \"arrow\"\n\n        inside.innerText = this.content\n        aside.appendChild(arr);\n        aside.appendChild(inside);\n        shadow.appendChild(aside);\n        const rect = inside.getBoundingClientRect()\n        const lim = document.body.clientWidth;\n        console.log(rect.x, lim)\n\n        //repositions div to fit on screen\n        if ((rect.x + rect.width) > lim){\n            let dif = (rect.x + rect.width) - lim\n            let newpos = rect.x - dif\n            console.log(\"o\",newpos )\n            aside.style.left =  (-1*dif - 10) + \"px\"\n        }\n        if (rect.x < 0){\n            aside.style.left =  10 + \"px\"\n        }\n\n        //calculations for arrow\n        const near = distance(this, aside)\n        const w = aside.getBoundingClientRect().width\n        const perc = (near/w) * 100\n        console.log(near, arr.style, (near/w) * 100)\n        arr.style.left = perc + \"%\";\n    }\n  }\n  \ncustomElements.define(\"t-ftn\", Footnote);\n","export function distance(tdiv, bdiv) {\n    const trect = tdiv.getBoundingClientRect();\n    const brect = bdiv.getBoundingClientRect();\n    const bleftx = brect.left;\n    const blefty = brect.top;\n    const tcenterx = trect.left + trect.width / 2;\n    const tbottomy = trect.bottom;\n    const distance = Math.hypot(bleftx - tcenterx, tbottomy - blefty);\n\n    return distance;\n}\n"],"names":["ftns","document","querySelectorAll","options","querySelector","hover","dataset","unhover","unhoverdelete","hoverDelay","undefined","hoverdelay","toggleFootnote","removeAllFootnotes","this","vis","shadowRoot","children","style","visibility","addFootnote","removeFootnote","async","removeFootnoteWithTimer","setTimeout","curr","forEach","ftn","window","addEventListener","e","target","i","removeEventListener","initializeFootnotes","Footnote","HTMLElement","constructor","super","content","connectedCallback","shadow","attachShadow","mode","child","item","console","log","matches","innerText","removeChild","appendChild","aside","createElement","part","classList","add","inside","arr","rect","getBoundingClientRect","lim","body","clientWidth","x","width","dif","newpos","left","near","tdiv","bdiv","trect","brect","bleftx","blefty","top","tcenterx","tbottomy","bottom","Math","hypot","distance","w","perc","customElements","define"],"mappings":"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"}