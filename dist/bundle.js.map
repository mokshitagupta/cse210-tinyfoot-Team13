{"version":3,"file":"bundle.js","sources":["../src/actions.js","../src/index.js","../src/utils.js"],"sourcesContent":["\n// toggles visibility when the note is clicked\nexport function toggleFootnote(){\n    removeAllFootnotes(this);\n    var vis = this.shadowRoot.children[1].style.visibility;\n    if(vis == 'hidden'){\n        this.shadowRoot.children[1].style.visibility = 'visible';\n    }else{\n        this.shadowRoot.children[1].style.visibility = 'hidden';\n    }\n}\n\n// adds visibility to clicked footnote\nexport function addFootnote(){\n    removeAllFootnotes();\n    this.shadowRoot.children[1].style.visibility = 'visible';\n}\n\n// removes visibility from clicked footnote\nexport function removeFootnote(){\n    this.shadowRoot.children[1].style.visibility = 'hidden';\n}\n\n// removes visibility from all footnotes except for current note (if there is one)\n// curr = current note\nexport function removeAllFootnotes(curr){\n    document.querySelectorAll('t-ftn').forEach(ftn => {\n        if(ftn !== curr){\n            ftn.shadowRoot.children[1].style.visibility = 'hidden';\n        }\n    })\n}\n\n","import {addFootnote, removeAllFootnotes, toggleFootnote, removeFootnote} from './actions.js'\nimport {distance} from './utils.js'\n\nlet content = {}\nlet ftns = document.querySelectorAll(\"t-ftn\"); //selects all footnotes\n\n//options\nlet options = document.querySelector(\"t-options\");\nvar hover = options.dataset.hover === 'true';\nvar unhover = options.dataset.unhoverdelete === 'true';\nlet hoverDelay = options.dataset.hoverdelay === undefined ? 0 : options.dataset.hoverdelay;\n\n//removes all footnotes except the one that is opened\nwindow.addEventListener(\"click\", (e) => removeAllFootnotes(e.target));\n\n\nfor(let i of ftns){\n    content[i] = i.innerHTML\n\n    // option grabbing\n    let hover = i.getAttribute(\"data-hover\")\n\n    // hover/click option hub (more options to be added)\n    if(hover){\n        i.addEventListener(\"mouseenter\", addFootnote);\n        i.addEventListener(\"click\", removeFootnote);\n    }else{\n        i.addEventListener(\"click\", toggleFootnote);  \n    }\n\n    if(unhover){\n        i.addEventListener(\"mouseout\", removeFootnoteWithTimer);\n    }\n}\n\n\n// Create a class for the element\nclass Footnote extends HTMLElement {\n    constructor() {\n      // Always call super first in constructor\n      super();\n      this.content = \"\"\n    }\n  \n    connectedCallback() {\n        const shadow = this.attachShadow({ mode: \"open\" });\n        const child = this.children.item(0);\n        console.log(this.children)\n        if (child && child.matches(\"a[href]\")) {\n            this.content = child.innerText;\n            child.innerText = \"\";\n            this.removeChild(child);\n            shadow.appendChild(child);\n        }\n\n        const aside = document.createElement(\"aside\");\n        aside.part = \"aside\"\n        aside.style.visibility = 'hidden';\n        aside.classList.add(\"aside\")\n        const inside = document.createElement(\"div\");\n        inside.part = \"content\"\n        const arr = document.createElement(\"div\");\n        arr.part = \"arrow\"\n\n        inside.innerText = this.content\n        aside.appendChild(arr);\n        aside.appendChild(inside);\n        shadow.appendChild(aside);\n        const rect = inside.getBoundingClientRect()\n        const lim = document.body.clientWidth;\n        console.log(rect.x, lim)\n\n        //repositions div to fit on screen\n        if ((rect.x + rect.width) > lim){\n            let dif = (rect.x + rect.width) - lim\n            let newpos = rect.x - dif\n            console.log(\"o\",newpos )\n            aside.style.left =  (-1*dif - 10) + \"px\"\n        }\n        if (rect.x < 0){\n            aside.style.left =  10 + \"px\"\n        }\n\n        //calculations for arrow\n        const near = distance(this, aside)\n        const w = aside.getBoundingClientRect().width\n        const perc = (near/w) * 100\n        console.log(near, arr.style, (near/w) * 100)\n        arr.style.left = perc + \"%\";\n    }\n  }\n\ncustomElements.define(\"t-ftn\", Footnote)","export function distance(tdiv, bdiv) {\n    const trect = tdiv.getBoundingClientRect();\n    const brect = bdiv.getBoundingClientRect();\n    const bleftx = brect.left;\n    const blefty = brect.top;\n    const tcenterx = trect.left + trect.width / 2;\n    const tbottomy = trect.bottom;\n    const distance = Math.hypot(bleftx - tcenterx, tbottomy - blefty);\n\n    return distance;\n}\n"],"names":["toggleFootnote","removeAllFootnotes","this","vis","shadowRoot","children","style","visibility","addFootnote","removeFootnote","curr","document","querySelectorAll","forEach","ftn","ftns","options","querySelector","dataset","hover","unhover","unhoverdelete","undefined","hoverdelay","window","addEventListener","e","target","i","innerHTML","getAttribute","removeFootnoteWithTimer","Footnote","HTMLElement","constructor","super","content","connectedCallback","shadow","attachShadow","mode","child","item","console","log","matches","innerText","removeChild","appendChild","aside","createElement","part","classList","add","inside","arr","rect","getBoundingClientRect","lim","body","clientWidth","x","width","dif","newpos","left","near","tdiv","bdiv","trect","brect","bleftx","blefty","top","tcenterx","tbottomy","bottom","Math","hypot","distance","w","perc","customElements","define"],"mappings":"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"}